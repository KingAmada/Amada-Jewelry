<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Amada Realty | The Sovereign Standard</title>

  <!-- SEO -->
  <meta name="description" content="Amada Realty — jewelry that isn't just worn, it's deeded. Secure deed-backed luxury assets, generate certificates, and access sovereign-tier inventory through a private client portal." />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="/" />
  <meta property="og:title" content="Amada Realty | The Sovereign Standard" />
  <meta property="og:description" content="Wear your assets. Secure deed-backed luxury jewelry & real estate titles. Private marketplace + certificates + concierge." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1200" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Amada Realty | The Sovereign Standard" />
  <meta name="twitter:description" content="Jewelry that isn't just worn—it's deeded. Private marketplace + certificates + concierge." />
  <meta name="twitter:image" content="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1200" />

  <!-- Dependencies -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Inter:wght@200;300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet" />

  <!-- Tailwind Configuration -->
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            gold: {
              50: "#FBF7E7",
              100: "#F6EECF",
              200: "#ECDC9F",
              300: "#E2CA6F",
              400: "#D4AF37",
              500: "#B89225",
              600: "#99761A",
              700: "#7A5E15",
              800: "#5C4610",
              900: "#3D2F0B",
            },
            obsidian: "#050505",
            charcoal: "#121212",
          },
          fontFamily: {
            sans: ["Inter", "sans-serif"],
            serif: ["Playfair Display", "serif"],
            display: ["Cinzel", "serif"],
          },
          animation: {
            float: "float 6s ease-in-out infinite",
            "fade-in": "fadeIn 0.5s ease-out forwards",
            "slide-up": "slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards",
          },
          keyframes: {
            float: { "0%, 100%": { transform: "translateY(0)" }, "50%": { transform: "translateY(-10px)" } },
            fadeIn: { "0%": { opacity: "0" }, "100%": { opacity: "1" } },
            slideUp: { "0%": { transform: "translateY(20px)", opacity: "0" }, "100%": { transform: "translateY(0)", opacity: "1" } },
          },
        },
      },
    };
  </script>

  <style>
    :root { --app-bg: #F5F5F7; }
    body { background-color: var(--app-bg); color: #1d1d1f; -webkit-font-smoothing: antialiased; overflow-x: hidden; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.4); }
    .text-gradient-gold { background: linear-gradient(135deg, #D4AF37 0%, #F4DF89 50%, #AA8C2C 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

    .mac-window {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 20px 50px rgba(0,0,0,0.1);
      border-radius: 24px;
      transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 20px;
    }

    input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none; height: 32px; width: 32px; border-radius: 50%;
      background: #D4AF37; cursor: pointer; margin-top: -14px;
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
      border: 4px solid white; transition: transform 0.1s;
    }
    input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }
    input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #E5E7EB; border-radius: 99px; }

    .dashboard-grid { display: grid; grid-template-columns: 280px 1fr; height: 100vh; overflow: hidden; }
    @media (max-width: 1024px) { .dashboard-grid { grid-template-columns: 1fr; } .sidebar-desktop { display: none; } }
    .nav-item.active { background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.05); font-weight: 600; color: #000; }
    .badge { position: absolute; top: -5px; right: -5px; background: #FF3B30; color: white; font-size: 10px; font-weight: bold; padding: 2px 6px; border-radius: 10px; box-shadow: 0 2px 5px rgba(255, 59, 48, 0.3); }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* Social proof floaters */
    .sp-wrap {
      position: fixed;
      left: 18px;
      bottom: 18px;
      z-index: 500;
      display: flex;
      flex-direction: column;
      gap: 10px;
      pointer-events: none;
    }
    .sp-card {
      width: min(420px, calc(100vw - 36px));
      pointer-events: all;
      background: rgba(255,255,255,0.92);
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 18px 50px rgba(0,0,0,0.12);
      border-radius: 18px;
      overflow: hidden;
      transform: translateY(16px);
      opacity: 0;
      animation: sp-in 420ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
    @keyframes sp-in { to { transform: translateY(0); opacity: 1; } }
    .sp-card.out { animation: sp-out 350ms ease forwards; }
    @keyframes sp-out { to { transform: translateY(10px); opacity: 0; } }
    .sp-top {
      display:flex; align-items:center; justify-content:space-between;
      padding: 12px 14px;
      background: linear-gradient(135deg, rgba(212,175,55,0.20), rgba(255,255,255,0));
    }
    .sp-title { font-size: 12px; font-weight: 800; letter-spacing: 0.14em; text-transform: uppercase; color: #111; }
    .sp-close { width: 34px; height: 34px; border-radius: 999px; background: rgba(0,0,0,0.04); display:flex; align-items:center; justify-content:center; cursor:pointer; }
    .sp-close:hover { background: rgba(0,0,0,0.08); }
    .sp-body { padding: 12px 14px 14px; display:flex; gap: 12px; align-items:flex-start; }
    .sp-ico {
      width: 44px; height: 44px; border-radius: 14px;
      background: #111; color: #D4AF37;
      display:flex; align-items:center; justify-content:center;
      flex-shrink: 0;
    }
    .sp-msg { font-size: 13px; color: #333; line-height: 1.35; }
    .sp-sub { font-size: 11px; color: #6b7280; margin-top: 6px; letter-spacing: 0.06em; text-transform: uppercase; }
    .sp-chip {
      display:inline-flex; align-items:center; gap: 6px;
      padding: 6px 10px; border-radius: 999px;
      font-size: 10px; font-weight: 800; letter-spacing: 0.12em; text-transform: uppercase;
      background: rgba(0,0,0,0.04); color: #111; margin-top: 10px;
    }

    /* Luxury A4 doc template */
    #print-root { position: fixed; left: -9999px; top: 0; width: 794px; }
    .doc-a4 { width: 794px; height: 1123px; background: #fff; position: relative; font-family: "Playfair Display", serif; color: #111; overflow: hidden; }
    .doc-border { position: absolute; inset: 24px; border-radius: 28px; border: 2px solid rgba(212,175,55,0.75); }
    .doc-inner { position: absolute; inset: 44px; border-radius: 22px; border: 1px solid rgba(0,0,0,0.08); padding: 42px; }
    .doc-watermark {
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      font-family: "Cinzel", serif;
      font-size: 120px;
      letter-spacing: 0.22em;
      color: rgba(0,0,0,0.04);
      transform: rotate(-18deg);
      user-select:none;
    }
    .doc-head { display:flex; justify-content:space-between; align-items:flex-start; gap: 18px; }
    .doc-brand { display:flex; align-items:center; gap: 12px; font-family:"Cinzel", serif; letter-spacing:0.26em; font-size: 20px; }
    .doc-seal { width: 54px; height: 54px; border-radius: 18px; background: #111; color: #D4AF37; display:flex; align-items:center; justify-content:center; }
    .doc-title { margin-top: 18px; font-family:"Cinzel", serif; letter-spacing:0.18em; font-size: 22px; text-transform: uppercase; }
    .doc-subtitle { margin-top: 6px; font-size: 13px; color: #374151; }
    .doc-grid { margin-top: 26px; display:grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .doc-card { border: 1px solid rgba(0,0,0,0.08); border-radius: 16px; padding: 14px; background: rgba(0,0,0,0.02); }
    .doc-k { font-size: 10px; letter-spacing: 0.16em; text-transform: uppercase; color: #6b7280; font-weight: 800; }
    .doc-v { margin-top: 6px; font-size: 14px; font-weight: 700; font-family: "Inter", sans-serif; }
    .doc-body { margin-top: 22px; font-family:"Inter", sans-serif; font-size: 13px; line-height: 1.7; color: #111; }
    .doc-qr {
      width: 120px; height: 120px; border-radius: 18px;
      border: 1px dashed rgba(0,0,0,0.18);
      display:flex; align-items:center; justify-content:center;
      font-size: 10px; color: #6b7280;
      background: rgba(212,175,55,0.06);
      text-align: center;
      padding: 10px;
    }
    .doc-sign { margin-top: 26px; display:flex; justify-content:space-between; align-items:flex-end; gap: 18px; }
    .sig-line { width: 240px; border-top: 1px solid rgba(0,0,0,0.25); padding-top: 8px; font-family:"Inter", sans-serif; font-size: 11px; color: #374151; }
    .doc-foot {
      position:absolute; left: 44px; right: 44px; bottom: 44px;
      display:flex; justify-content:space-between; align-items:center;
      font-family:"Inter", sans-serif;
      font-size: 10px;
      letter-spacing:0.12em;
      text-transform: uppercase;
      color: #6b7280;
    }

    /* small helpers */
    .pill { display:inline-flex; align-items:center; gap: 8px; border-radius: 999px; padding: 8px 12px; font-size: 11px; font-weight: 800; letter-spacing: 0.14em; text-transform: uppercase; }
    .line-clamp-2 {
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
    }
  </style>
</head>

<body class="selection:bg-gold-200 selection:text-black">

  <!-- =========================================================================
       LAYER 1: PUBLIC WEBSITE
       ========================================================================= -->
  <div id="public-site" class="transition-opacity duration-700">

    <!-- LOADER -->
    <div id="loader" class="fixed inset-0 z-[9999] bg-white flex flex-col items-center justify-center transition-opacity duration-1000">
      <div class="relative">
        <div class="w-24 h-24 border-4 border-gray-100 rounded-full animate-spin border-t-gold-400"></div>
        <i class="fas fa-crown absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-gold-500 text-2xl"></i>
      </div>
      <h1 class="font-display text-2xl mt-6 tracking-[0.3em] text-gray-900">AMADA</h1>
      <p class="text-xs text-gray-400 mt-2 uppercase tracking-widest">Initializing Secure Environment...</p>
    </div>

    <!-- NAV BAR -->
    <nav class="fixed top-0 w-full z-50 transition-all duration-300 px-4 md:px-6 py-4" id="main-nav">
      <div class="max-w-7xl mx-auto mac-window !rounded-full px-6 md:px-8 py-3 flex justify-between items-center bg-white/90">
        <a href="#" class="flex items-center gap-3 group" onclick="window.scrollTo({top:0, behavior:'smooth'}); return false;">
          <div class="w-10 h-10 bg-black text-white rounded-full flex items-center justify-center group-hover:bg-gold-500 transition-colors duration-500">
            <i class="fas fa-gem text-lg"></i>
          </div>
          <span class="font-display font-bold text-xl tracking-widest text-gray-900 group-hover:text-gold-600 transition-colors">AMADA</span>
        </a>

        <div class="hidden md:flex items-center gap-8 font-sans text-sm font-medium text-gray-600">
          <a href="#collection" class="hover:text-black transition">Collection</a>
          <a href="#tiers" class="hover:text-black transition">Tiers</a>
          <a href="#concierge" class="hover:text-black transition">Concierge</a>
        </div>

        <div class="flex items-center gap-4">
          <button onclick="App.openDashboard('marketplace')" class="w-10 h-10 rounded-full hover:bg-gray-100 flex items-center justify-center transition" title="Search private inventory">
            <i class="fas fa-search text-gray-500"></i>
          </button>
          <button onclick="App.openDashboard('overview')" class="bg-black text-white px-6 py-2.5 rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-500 hover:scale-105 transition-all shadow-lg">
            Client Portal
          </button>
        </div>
      </div>
    </nav>

    <!-- HERO -->
    <header class="relative min-h-screen flex items-center justify-center overflow-hidden pt-20">
      <div class="absolute inset-0 z-0">
        <div class="absolute top-[-10%] left-[-10%] w-[60%] h-[60%] bg-gold-200 rounded-full mix-blend-multiply filter blur-[120px] opacity-30 animate-float"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-blue-100 rounded-full mix-blend-multiply filter blur-[120px] opacity-30 animate-float" style="animation-delay: 2s"></div>
      </div>

      <div class="container mx-auto px-4 z-10 text-center">
        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/50 backdrop-blur-md border border-white/60 mb-8 animate-fade-in">
          <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
          <span class="text-xs uppercase tracking-widest font-semibold text-gray-600">Market Status: Bullish</span>
        </div>

        <h1 class="font-display text-5xl md:text-8xl font-bold text-gray-900 leading-[1.1] mb-8 animate-fade-in" style="animation-delay: 0.1s">
          The Geometry of <br />
          <span class="text-gradient-gold">Wealth.</span>
        </h1>

        <p class="font-sans font-light text-lg md:text-xl text-gray-600 max-w-2xl mx-auto mb-12 leading-relaxed animate-fade-in" style="animation-delay: 0.2s">
          Jewelry that isn't just worn—it's deeded. Amada Realty fuses high-carat gemstones with prime real estate titles.
          <span class="font-medium text-black">Wear your assets.</span>
        </p>

        <div class="flex flex-col md:flex-row items-center justify-center gap-6 animate-fade-in" style="animation-delay: 0.3s">
          <a href="#tiers" class="group relative px-8 py-4 bg-black text-white rounded-full overflow-hidden shadow-2xl">
            <span class="absolute inset-0 w-full h-full bg-gold-500 transform -translate-x-full group-hover:translate-x-0 transition-transform duration-500 ease-out"></span>
            <span class="relative font-bold uppercase text-xs tracking-[0.2em] flex items-center gap-2">
              Begin Acquisition <i class="fas fa-arrow-right"></i>
            </span>
          </a>
          <button onclick="App.openDashboard('marketplace')" class="px-8 py-4 rounded-full border border-white/60 bg-white/40 backdrop-blur font-bold uppercase text-xs tracking-[0.2em] hover:bg-white/70 transition shadow-lg">
            View Private Inventory
          </button>
        </div>

        <!-- subtle FOMO strip -->
        <div class="mt-12 inline-flex items-center gap-3 px-5 py-3 rounded-full bg-white/55 backdrop-blur border border-white/70 text-xs uppercase tracking-widest font-bold text-gray-700">
          <i class="fas fa-lock text-gold-600"></i>
          <span>Quiet drops rotate daily • Access varies by tier</span>
          <span class="px-3 py-1 rounded-full bg-black text-white text-[10px]">Limited visibility</span>
        </div>
      </div>
    </header>

    <!-- TIERS -->
    <section id="tiers" class="py-32 bg-gray-50 relative overflow-hidden">
      <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-16">
          <h2 class="font-display text-4xl mb-4">The Hierarchy of Access</h2>
          <p class="text-gray-500 font-light">Click or drag. Service levels adjust automatically to your capital commitment.</p>
        </div>

        <div class="mac-window p-8 md:p-12 max-w-5xl mx-auto bg-white/80">
          <div class="mb-16 px-4">
            <!-- Clickable Labels -->
            <div class="flex justify-between text-xs font-bold uppercase tracking-widest text-gray-400 mb-4 select-none">
              <span class="cursor-pointer hover:text-gold-600 transition" onclick="App.setTier(1)">Entry</span>
              <span class="cursor-pointer hover:text-gold-600 transition" onclick="App.setTier(3)">Exclusive</span>
              <span class="cursor-pointer hover:text-gold-600 transition" onclick="App.setTier(5)">Sovereign</span>
            </div>

            <input type="range" id="tier-slider" min="1" max="5" value="1" step="1" oninput="App.updateTier(this.value)" />

            <!-- Clickable Price Points -->
            <div class="flex justify-between mt-4 font-display text-sm text-gray-900 select-none">
              <button onclick="App.setTier(1)" class="hover:text-gold-600 transition focus:outline-none">₦100k</button>
              <button onclick="App.setTier(2)" class="hover:text-gold-600 transition focus:outline-none">₦10M</button>
              <button onclick="App.setTier(3)" class="hover:text-gold-600 transition focus:outline-none">₦50M</button>
              <button onclick="App.setTier(4)" class="hover:text-gold-600 transition focus:outline-none">₦500M</button>
              <button onclick="App.setTier(5)" class="hover:text-gold-600 transition focus:outline-none">₦5B+</button>
            </div>
          </div>

          <div id="tier-display" class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center transition-all duration-500">
            <!-- Injected via JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- PUBLIC COLLECTION TEASER -->
    <section id="collection" class="py-24 bg-white">
      <div class="container mx-auto px-4">
        <div class="flex flex-col md:flex-row justify-between items-end mb-12">
          <div>
            <h2 class="font-display text-4xl mb-2">Curated Assets</h2>
            <p class="text-gray-500">Live inventory available for immediate securing.</p>
          </div>
          <button onclick="App.openDashboard('marketplace')" class="mt-4 md:mt-0 px-6 py-3 border border-gray-200 rounded-full text-xs font-bold uppercase tracking-widest hover:bg-black hover:text-white transition group">
            Enter Marketplace <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
          </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8" id="public-products-grid">
          <!-- Loaded via JS -->
        </div>
      </div>
    </section>

    <!-- SOCIAL PROOF + PARTNERS + TESTIMONIALS -->
    <section class="py-20 bg-gray-50">
      <div class="container mx-auto px-4">
        <!-- STATS PROOF -->
        <div class="mac-window p-10 bg-white/85">
          <div class="flex flex-col md:flex-row md:items-end justify-between gap-8">
            <div>
              <h2 class="font-display text-4xl mb-3">Proof of Standard</h2>
              <p class="text-gray-500 max-w-2xl">Not hype. Signals. A private market where ownership is documented, auditable, and treated as ceremony.</p>
            </div>
            <button onclick="App.openDashboard('marketplace')" class="px-6 py-3 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">
              Enter Private Inventory
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mt-10">
            <div class="glass-card p-6">
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Assets Deeded</p>
              <p class="font-display text-3xl mt-3">₦124B+</p>
              <p class="text-xs text-gray-500 mt-2">Across prime zones & rare holdings.</p>
            </div>
            <div class="glass-card p-6">
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Elite Clients</p>
              <p class="font-display text-3xl mt-3">3,812</p>
              <p class="text-xs text-gray-500 mt-2">Private clients across tiers.</p>
            </div>
            <div class="glass-card p-6">
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Retention</p>
              <p class="font-display text-3xl mt-3">97%</p>
              <p class="text-xs text-gray-500 mt-2">Clients return for the next drop.</p>
            </div>
            <div class="glass-card p-6">
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Avg. Time to Secure</p>
              <p class="font-display text-3xl mt-3">3m</p>
              <p class="text-xs text-gray-500 mt-2">From discovery → documentation.</p>
            </div>
          </div>
        </div>

        <!-- PARTNERS PROOF -->
        <div class="mt-10 mac-window p-10 bg-white/85">
          <div class="flex items-center justify-between gap-6 flex-wrap">
            <div>
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Trusted Ecosystem</p>
              <h3 class="font-display text-2xl mt-2">Partners Who Understand Discretion</h3>
            </div>
            <p class="text-sm text-gray-500 max-w-xl">
              Registry, legal, security, and valuation partners — selected for integrity, not popularity.
            </p>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mt-8 text-center">
            <div class="glass-card p-4 font-bold text-gray-700">Atlas Registry</div>
            <div class="glass-card p-4 font-bold text-gray-700">Crown Valuations</div>
            <div class="glass-card p-4 font-bold text-gray-700">Obsidian Legal</div>
            <div class="glass-card p-4 font-bold text-gray-700">Gild Protocol</div>
            <div class="glass-card p-4 font-bold text-gray-700">Vault Security</div>
            <div class="glass-card p-4 font-bold text-gray-700">Aurum Audit</div>
          </div>
          <p class="text-xs text-gray-400 mt-6">Demo placeholders — swap with real logos later.</p>
        </div>

        <!-- TESTIMONIALS -->
        <div class="mt-10 grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="mac-window p-8 bg-white/85">
            <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Testimonial</p>
            <p class="font-serif text-lg mt-4 leading-relaxed">
              “The first time I saw a deed presented like fine art, I understood: this isn’t jewelry.
              It’s status with paperwork. It felt… inevitable.”
            </p>
            <div class="mt-6 text-sm">
              <p class="font-bold">A. Nwosu</p>
              <p class="text-gray-500">Private Client • Tier 4</p>
            </div>
          </div>

          <div class="mac-window p-8 bg-white/85">
            <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Testimonial</p>
            <p class="font-serif text-lg mt-4 leading-relaxed">
              “When my certificate arrived, it didn’t read like a PDF. It read like a vow.
              That level of detail changes how you carry an asset.”
            </p>
            <div class="mt-6 text-sm">
              <p class="font-bold">F. Adeyemi</p>
              <p class="text-gray-500">Investor • Portfolio Holder</p>
            </div>
          </div>

          <div class="mac-window p-8 bg-white/85">
            <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Testimonial</p>
            <p class="font-serif text-lg mt-4 leading-relaxed">
              “The marketplace feels like a private auction room — quiet, confident, decisive.
              That’s the psychology of premium.”
            </p>
            <div class="mt-6 text-sm">
              <p class="font-bold">M. Hassan</p>
              <p class="text-gray-500">Founder • Tier 3</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-black text-white pt-24 pb-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-12 border-b border-gray-800 pb-16">
          <div class="col-span-1 md:col-span-2">
            <span class="font-display text-2xl tracking-widest mb-6 block">AMADA</span>
            <p class="text-gray-400 max-w-sm font-light leading-relaxed">
              Redefining the physics of ownership. Where geology meets geography.
            </p>
          </div>
          <div>
            <h4 class="text-gold-500 text-xs font-bold uppercase tracking-widest mb-6">Protocol</h4>
            <ul class="space-y-4 text-sm text-gray-400">
              <li><a href="#tiers" class="hover:text-white transition">The ONCE Service</a></li>
              <li><a href="#" onclick="App.openDashboard('documents'); return false;" class="hover:text-white transition">Verify Certificate</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-gold-500 text-xs font-bold uppercase tracking-widest mb-6">Connect</h4>
            <div class="flex space-x-6 text-gray-400">
              <a href="#" class="hover:text-white transition" aria-label="Instagram"><i class="fab fa-instagram text-xl"></i></a>
              <a href="#" class="hover:text-white transition" aria-label="Twitter"><i class="fab fa-twitter text-xl"></i></a>
            </div>
          </div>
        </div>
        <div class="pt-8 text-center md:text-left text-xs text-gray-600 uppercase tracking-widest">
          <p>&copy; 2026 Amada Realty Ltd.</p>
        </div>
      </div>
    </footer>
  </div>

  <!-- =========================================================================
       LAYER 2: CLIENT DASHBOARD (THE "OS")
       ========================================================================= -->
  <div id="dashboard-os" class="fixed inset-0 z-[100] bg-[#eef1f5] transform translate-y-full transition-transform duration-700 ease-[cubic-bezier(0.83,0,0.17,1)] overflow-hidden">
    <div class="absolute inset-0 bg-white/40 pointer-events-none"></div>

    <div class="dashboard-grid relative z-10">

      <!-- SIDEBAR -->
      <aside class="sidebar-desktop m-4 rounded-[32px] bg-white/60 backdrop-blur-xl border border-white/40 shadow-xl flex flex-col justify-between p-6">
        <div>
          <!-- Profile -->
          <div class="flex items-center gap-4 mb-10 px-2 cursor-pointer" onclick="App.switchTab('settings')">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-gray-800 to-black p-[2px]">
              <img id="sidebar-avatar" src="https://i.pravatar.cc/150?img=11" class="w-full h-full rounded-full border-2 border-white object-cover" alt="avatar">
            </div>
            <div>
              <p id="sidebar-name" class="font-display font-bold text-gray-900">—</p>
              <p id="sidebar-tier" class="text-xs text-gold-600 font-bold uppercase tracking-wider">Tier: —</p>
            </div>
          </div>

          <!-- Nav -->
          <nav class="space-y-2">
            <button onclick="App.switchTab('overview')" class="nav-item active w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50">
              <i class="fas fa-th-large w-5 text-center"></i> Overview
            </button>
            <button onclick="App.switchTab('wallet')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50">
              <i class="fas fa-wallet w-5 text-center"></i> My Assets
            </button>
            <button onclick="App.switchTab('marketplace')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50 relative">
              <i class="fas fa-store w-5 text-center"></i> Marketplace
              <span class="badge">New</span>
            </button>
            <button onclick="App.switchTab('concierge')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50">
              <i class="fas fa-concierge-bell w-5 text-center"></i> Concierge
            </button>
            <button onclick="App.switchTab('documents')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50">
              <i class="fas fa-file-contract w-5 text-center"></i> Documents
            </button>
            <button onclick="App.switchTab('settings')" class="nav-item w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm transition-all text-gray-600 hover:bg-white/50">
              <i class="fas fa-cog w-5 text-center"></i> Settings
            </button>
          </nav>
        </div>

        <div>
          <button onclick="App.closeDashboard()" class="w-full flex items-center gap-4 px-4 py-3 rounded-2xl text-sm text-red-500 hover:bg-red-50 transition-all font-medium">
            <i class="fas fa-power-off w-5 text-center"></i> Logout
          </button>
        </div>
      </aside>

      <!-- MAIN CONTENT -->
      <main class="p-4 md:pl-0 h-full overflow-y-auto no-scrollbar relative">

        <!-- DASHBOARD TOP BAR -->
        <header class="flex justify-between items-center mb-6 px-2 pt-2 sticky top-0 z-40">
          <div class="flex items-center gap-3">
            <h2 id="page-title" class="font-display text-2xl font-bold text-gray-900">Portfolio Overview</h2>
            <span id="quiet-window-pill" class="pill bg-white/70 border border-white/70 text-gray-800 hidden">
              <i class="fas fa-hourglass-half text-gold-600"></i>
              <span id="quiet-window-text">Quiet window: --:--:--</span>
            </span>
          </div>
          <div class="flex items-center gap-4">
            <button onclick="App.showToast('Notification', 'Market up 2.4% today')" class="w-10 h-10 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-gold-600 transition relative" title="Notifications">
              <i class="far fa-bell"></i>
              <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full"></span>
            </button>
            <button onclick="App.closeDashboard()" class="md:hidden bg-gray-900 text-white px-4 py-2 rounded-full text-xs font-bold">Exit</button>
          </div>
        </header>

        <!-- TAB: OVERVIEW -->
        <div id="tab-overview" class="tab-content space-y-6 animate-slide-up">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="mac-window p-6 bg-gradient-to-br from-gray-900 to-black text-white">
              <div class="flex justify-between items-start mb-8">
                <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-gold-400">
                  <i class="fas fa-chart-pie"></i>
                </div>
                <span class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wide">+14.2%</span>
              </div>
              <p class="text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Total Valuation</p>
              <h3 id="overview-total" class="font-display text-3xl">₦0</h3>
            </div>

            <div class="glass-card p-6">
              <div class="flex justify-between items-start mb-8">
                <div class="w-10 h-10 rounded-full bg-gold-100 flex items-center justify-center text-gold-600">
                  <i class="fas fa-gem"></i>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-widest mb-1">Rare Earth</p>
              <h3 id="overview-rare" class="font-display text-3xl text-gray-900">₦0</h3>
            </div>

            <div class="glass-card p-6">
              <div class="flex justify-between items-start mb-8">
                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                  <i class="fas fa-building"></i>
                </div>
              </div>
              <p class="text-gray-500 text-xs font-bold uppercase tracking-widest mb-1">Investments</p>
              <h3 id="overview-invest" class="font-display text-3xl text-gray-900">₦0</h3>
            </div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2 mac-window p-6">
              <div class="flex items-center justify-between mb-6">
                <h3 class="font-display text-lg">Asset Appreciation</h3>
                <span class="text-xs font-bold uppercase tracking-widest text-gray-400">Demo chart</span>
              </div>
              <canvas id="mainChart" height="250"></canvas>
            </div>
            <div class="mac-window p-6">
              <div class="flex items-center justify-between mb-6">
                <h3 class="font-display text-lg">Split</h3>
                <span class="text-xs font-bold uppercase tracking-widest text-gray-400">Demo chart</span>
              </div>
              <canvas id="pieChart" height="250"></canvas>
            </div>
          </div>

          <!-- Activity / FOMO feed -->
          <div class="mac-window p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-display text-lg">Ledger Activity</h3>
              <button onclick="App.seedFomoActivity()" class="text-xs font-bold uppercase tracking-widest text-gold-700 hover:text-gold-600">Simulate Activity</button>
            </div>
            <div id="activity-feed" class="space-y-3">
              <!-- JS -->
            </div>
          </div>
        </div>

        <!-- TAB: WALLET -->
        <div id="tab-wallet" class="tab-content hidden space-y-6 animate-slide-up">
          <div class="mac-window p-5">
            <div class="flex flex-col md:flex-row justify-between gap-4 md:items-center">
              <div>
                <h3 class="font-display text-xl">Your Asset Wallet</h3>
                <p class="text-gray-500 text-sm">Every owned item can generate its full document pack: Certificate, Deed, Authenticity, Receipt.</p>
              </div>
              <button onclick="App.switchTab('documents')" class="px-5 py-3 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">
                Open Documents Hub
              </button>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="wallet-grid">
            <!-- JS -->
          </div>
        </div>

        <!-- TAB: MARKETPLACE -->
        <div id="tab-marketplace" class="tab-content hidden space-y-6 animate-slide-up">

          <!-- FOMO banner -->
          <div class="mac-window p-5 bg-white/85">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
              <div class="flex items-center gap-4">
                <div class="w-12 h-12 rounded-2xl bg-black text-gold-400 flex items-center justify-center">
                  <i class="fas fa-lock"></i>
                </div>
                <div>
                  <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Quiet Drop Protocol</p>
                  <p class="font-display text-xl">Inventory visibility is tier-gated.</p>
                  <p class="text-sm text-gray-500">Higher tiers reveal rarer assets. Some entries appear “quiet” and vanish without announcement.</p>
                </div>
              </div>
              <button onclick="App.showToast('Access', 'Tier rules applied. Filtering inventory...'); App.filterShop();" class="px-6 py-3 rounded-full bg-gray-900 text-white text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">
                Refresh Visibility
              </button>
            </div>
          </div>

          <!-- Search & Filters -->
          <div class="mac-window p-4 sticky top-0 z-30">
            <div class="flex flex-col gap-4">
              <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
                <!-- Search -->
                <div class="relative w-full md:w-96">
                  <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                  <input type="text" id="shop-search" onkeyup="App.filterShop()" placeholder="Search assets, locations, codes..." class="w-full pl-10 pr-4 py-3 bg-gray-50 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-gold-400 transition">
                </div>

                <!-- Sort / Type -->
                <div class="flex gap-2 w-full md:w-auto overflow-x-auto no-scrollbar">
                  <select id="shop-sort" onchange="App.filterShop()" class="bg-gray-50 border-none rounded-xl text-xs font-bold uppercase px-4 py-3 cursor-pointer outline-none hover:bg-gray-100">
                    <option value="default">Sort By: Featured</option>
                    <option value="price-asc">Price: Low to High</option>
                    <option value="price-desc">Price: High to Low</option>
                    <option value="newest">Newest Drops</option>
                  </select>
                  <select id="shop-filter-type" onchange="App.filterShop()" class="bg-gray-50 border-none rounded-xl text-xs font-bold uppercase px-4 py-3 cursor-pointer outline-none hover:bg-gray-100">
                    <option value="all">All Types</option>
                    <option value="Rare Earth">Rare Earth</option>
                    <option value="Investment">Investment</option>
                  </select>
                  <select id="shop-availability" onchange="App.filterShop()" class="bg-gray-50 border-none rounded-xl text-xs font-bold uppercase px-4 py-3 cursor-pointer outline-none hover:bg-gray-100">
                    <option value="all">All Status</option>
                    <option value="Available">Available</option>
                    <option value="Quiet">Quiet (Limited)</option>
                  </select>
                </div>
              </div>

              <!-- Tier Filter (click OR drag) -->
              <div class="bg-gray-50 rounded-2xl p-4">
                <div class="flex items-center justify-between mb-3">
                  <div>
                    <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Tier Filter</p>
                    <p class="text-sm text-gray-600">Show assets up to tier: <b id="shop-tier-label">5</b></p>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="pill bg-white border border-white text-gray-800">
                      <i class="fas fa-eye text-gold-600"></i>
                      <span id="shop-visible-count">0 visible</span>
                    </span>
                    <button onclick="App.resetShopFilters()" class="px-4 py-2 rounded-full bg-white border border-gray-100 text-xs font-bold uppercase tracking-widest hover:bg-gray-100">Reset</button>
                  </div>
                </div>

                <input type="range" id="shop-tier-slider" min="1" max="5" value="5" step="1" oninput="App.setShopTier(this.value, true)" />

                <div class="flex justify-between mt-3 font-display text-sm text-gray-900 select-none">
                  <button onclick="App.setShopTier(1)" class="hover:text-gold-600 transition focus:outline-none">₦100k</button>
                  <button onclick="App.setShopTier(2)" class="hover:text-gold-600 transition focus:outline-none">₦10M</button>
                  <button onclick="App.setShopTier(3)" class="hover:text-gold-600 transition focus:outline-none">₦50M</button>
                  <button onclick="App.setShopTier(4)" class="hover:text-gold-600 transition focus:outline-none">₦500M</button>
                  <button onclick="App.setShopTier(5)" class="hover:text-gold-600 transition focus:outline-none">₦5B+</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Products Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="marketplace-grid">
            <!-- JS -->
          </div>

          <div id="no-results" class="hidden text-center py-12 text-gray-400">
            <i class="fas fa-search mb-4 text-4xl opacity-20"></i>
            <p>No assets found matching your criteria.</p>
          </div>
        </div>

        <!-- TAB: CONCIERGE -->
        <div id="tab-concierge" class="tab-content hidden h-[calc(100vh-140px)] animate-slide-up">
          <div class="mac-window h-full flex flex-col overflow-hidden">
            <div class="p-4 bg-gray-50 border-b border-gray-200 flex justify-between">
              <div class="flex gap-3">
                <div class="w-10 h-10 rounded-full bg-gold-500 text-white flex items-center justify-center">
                  <i class="fas fa-user-tie"></i>
                </div>
                <div>
                  <p class="font-bold text-sm">Amada Private Office</p>
                  <p class="text-xs text-green-600">Online</p>
                </div>
              </div>
              <button onclick="App.showToast('Concierge', 'A specialist is being assigned.')" class="text-xs font-bold uppercase tracking-widest text-gold-700 hover:text-gold-600">
                Request Specialist
              </button>
            </div>
            <div class="flex-1 p-6 overflow-y-auto space-y-4 bg-white" id="chat-history">
              <div class="flex items-start gap-3">
                <div class="w-8 h-8 rounded-full bg-gold-500 text-white flex-shrink-0 flex items-center justify-center text-xs">
                  <i class="fas fa-user-tie"></i>
                </div>
                <div class="bg-gray-100 p-3 rounded-2xl rounded-tl-none max-w-[80%] text-sm">
                  Welcome back. Your document vault is ready. If you want a discreet transfer, say “quiet transfer”.
                </div>
              </div>
            </div>
            <div class="p-4 bg-gray-50 border-t flex gap-2">
              <input type="text" id="chat-input" placeholder="Type message..." class="flex-1 bg-white border border-gray-300 rounded-full px-4 text-sm focus:outline-none focus:border-gold-500" onkeypress="if(event.key === 'Enter') App.sendMessage()">
              <button onclick="App.sendMessage()" class="w-10 h-10 rounded-full bg-gold-500 text-white hover:bg-gold-600"><i class="fas fa-paper-plane"></i></button>
            </div>
          </div>
        </div>

        <!-- TAB: DOCUMENTS -->
        <div id="tab-documents" class="tab-content hidden space-y-6 animate-slide-up">
          <div class="mac-window p-6">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
              <div>
                <h3 class="font-display text-xl">Document Vault</h3>
                <p class="text-gray-500 text-sm">Download premium A4 PDFs: Certificate, Deed, Authenticity Letter, Receipts.</p>
              </div>
              <div class="flex gap-2 flex-wrap">
                <button onclick="App.verifyDocPrompt()" class="px-5 py-3 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">
                  Verify Document
                </button>
                <button onclick="App.exportPortfolioStatement()" class="px-5 py-3 bg-white border border-gray-200 rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gray-100 transition">
                  Portfolio Statement (PDF)
                </button>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="documents-grid">
            <!-- JS -->
          </div>

          <div class="mac-window p-6">
            <h4 class="font-display text-lg mb-3">Verification Notes</h4>
            <p class="text-gray-600 text-sm leading-relaxed">
              In production, each document is cryptographically signed and verifiable via registry partners. In this demo, documents are generated locally and stamped with a stable ID for presentation and workflow simulation.
            </p>
          </div>
        </div>

        <!-- TAB: SETTINGS -->
        <div id="tab-settings" class="tab-content hidden space-y-6 animate-slide-up">
          <div class="mac-window p-8 max-w-2xl mx-auto">
            <div class="flex items-center gap-6 mb-8 border-b border-gray-100 pb-8">
              <div class="w-20 h-20 rounded-full bg-gray-200 overflow-hidden relative group cursor-pointer" onclick="App.randomizeAvatar()">
                <img id="settings-avatar" src="https://i.pravatar.cc/150?img=11" class="w-full h-full object-cover" alt="avatar">
                <div class="absolute inset-0 bg-black/40 hidden group-hover:flex items-center justify-center text-white text-xs uppercase">Shuffle</div>
              </div>
              <div>
                <h3 id="settings-name-title" class="font-display text-xl font-bold">—</h3>
                <p id="settings-email-title" class="text-gray-500 text-sm">—</p>
                <button onclick="App.showToast('Security', 'Password change is simulated in this demo.')" class="mt-2 text-gold-600 text-xs font-bold uppercase tracking-widest">Change Password</button>
              </div>
            </div>

            <form onsubmit="event.preventDefault(); App.saveSettings();">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                  <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Full Name</label>
                  <input id="settings-name" type="text" class="w-full p-3 bg-gray-50 rounded-xl text-sm border border-transparent focus:bg-white focus:border-gold-300 outline-none transition">
                </div>
                <div>
                  <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Email</label>
                  <input id="settings-email" type="email" class="w-full p-3 bg-gray-50 rounded-xl text-sm border border-transparent focus:bg-white focus:border-gold-300 outline-none transition">
                </div>
                <div>
                  <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Phone</label>
                  <input id="settings-phone" type="tel" class="w-full p-3 bg-gray-50 rounded-xl text-sm border border-transparent focus:bg-white focus:border-gold-300 outline-none transition">
                </div>
                <div>
                  <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Client Tier</label>
                  <select id="settings-tier" class="w-full p-3 bg-gray-50 rounded-xl text-sm border border-transparent focus:bg-white outline-none" onchange="App.onTierChangeFromSettings()">
                    <option value="1">Tier 1 (Entry)</option>
                    <option value="2">Tier 2 (Consult)</option>
                    <option value="3">Tier 3 (Priority)</option>
                    <option value="4">Tier 4 (Mobile)</option>
                    <option value="5">Tier 5 (ONCE)</option>
                  </select>
                </div>
              </div>

              <div class="mb-8">
                <h4 class="font-bold mb-4">Notifications</h4>
                <div class="space-y-3">
                  <label class="flex items-center gap-3 cursor-pointer">
                    <input id="notif-yield" type="checkbox" class="accent-gold-500 w-4 h-4">
                    <span class="text-sm text-gray-600">Investment Yield Alerts</span>
                  </label>
                  <label class="flex items-center gap-3 cursor-pointer">
                    <input id="notif-drops" type="checkbox" class="accent-gold-500 w-4 h-4">
                    <span class="text-sm text-gray-600">New Asset Drops (Rare Earth)</span>
                  </label>
                  <label class="flex items-center gap-3 cursor-pointer">
                    <input id="notif-quiet" type="checkbox" class="accent-gold-500 w-4 h-4">
                    <span class="text-sm text-gray-600">Quiet Mode Alerts (tier-gated)</span>
                  </label>
                </div>
              </div>

              <button type="submit" class="w-full py-4 bg-black text-white rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-gold-600 transition shadow-lg">
                Save Changes
              </button>
            </form>
          </div>
        </div>

      </main>
    </div>
  </div>

  <!-- =========================================================================
       LAYER 3: MODALS & OVERLAYS
       ========================================================================= -->

  <!-- PRODUCT MODAL -->
  <div id="product-modal" class="fixed inset-0 z-[200] hidden">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" onclick="App.closeProductModal()"></div>
    <div class="absolute inset-y-0 right-0 w-full md:w-[600px] bg-white shadow-2xl transform translate-x-full transition-transform duration-500 ease-[cubic-bezier(0.2,0.8,0.2,1)] overflow-y-auto" id="product-modal-panel">
      <button onclick="App.closeProductModal()" class="absolute top-6 right-6 z-10 w-10 h-10 bg-white/50 backdrop-blur rounded-full flex items-center justify-center hover:bg-white transition">
        <i class="fas fa-times"></i>
      </button>

      <div class="h-[400px] bg-gray-200 relative">
        <img id="modal-img" src="" class="w-full h-full object-cover" alt="asset image" />
        <div class="absolute bottom-4 left-0 right-0 flex justify-center gap-2">
          <span class="w-2 h-2 rounded-full bg-white"></span>
          <span class="w-2 h-2 rounded-full bg-white/50"></span>
        </div>

        <div class="absolute top-4 left-4 flex gap-2">
          <span id="modal-status-badge" class="pill bg-white/85 border border-white text-gray-800"><i class="fas fa-circle text-green-500"></i> <span>Available</span></span>
          <span id="modal-tier-badge" class="pill bg-black text-white"><i class="fas fa-crown text-gold-400"></i> <span>Tier 5</span></span>
        </div>
      </div>

      <div class="p-8">
        <div class="flex justify-between items-start mb-2">
          <h2 id="modal-title" class="font-display text-3xl font-bold"></h2>
          <span id="modal-price" class="font-sans font-bold text-xl text-gold-600"></span>
        </div>
        <p id="modal-type" class="text-xs font-bold uppercase tracking-widest text-gray-400 mb-2"></p>
        <p id="modal-location" class="text-sm text-gray-600 mb-6"></p>

        <p id="modal-desc" class="text-gray-600 leading-relaxed mb-8"></p>

        <div class="grid grid-cols-2 gap-4 mb-8 p-4 bg-gray-50 rounded-xl">
          <div>
            <p class="text-xs text-gray-400 uppercase">Location</p>
            <p id="modal-location-2" class="font-medium">—</p>
          </div>
          <div>
            <p class="text-xs text-gray-400 uppercase">Status</p>
            <p id="modal-status" class="font-medium text-green-600">Available</p>
          </div>
          <div>
            <p class="text-xs text-gray-400 uppercase">Asset Code</p>
            <p id="modal-code" class="font-medium mono">—</p>
          </div>
          <div>
            <p class="text-xs text-gray-400 uppercase">Tier</p>
            <p id="modal-tier" class="font-medium">—</p>
          </div>
        </div>

        <div class="mac-window p-4 bg-white/85 mb-6">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-xs font-bold uppercase tracking-widest text-gray-400">FOMO Signal</p>
              <p id="modal-fomo" class="text-sm text-gray-600 mt-1">—</p>
            </div>
            <button onclick="App.showToast('Vault', 'You will be notified if this asset enters quiet mode.')" class="px-4 py-2 rounded-full bg-gray-900 text-white text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">
              Follow
            </button>
          </div>
        </div>

        <button id="modal-secure-btn" onclick="App.addToWalletFromModal()" class="w-full py-4 bg-black text-white rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-gold-500 transition shadow-lg mb-3">
          Secure Asset
        </button>

        <button onclick="App.previewDocsFromModal()" class="w-full py-3 border border-gray-200 rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-gray-50 transition">
          Download Document Pack
        </button>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="fixed top-6 right-6 z-[300] bg-white/90 backdrop-blur border border-gray-200 shadow-2xl rounded-2xl p-4 flex items-center gap-4 transform translate-x-[200%] transition-transform duration-500">
    <div id="toast-icon" class="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center"><i class="fas fa-check"></i></div>
    <div>
      <h4 class="font-bold text-sm">Success</h4>
      <p class="text-xs text-gray-500">Operation completed.</p>
    </div>
  </div>

  <!-- SOCIAL PROOF CONTAINER -->
  <div id="sp-container" class="sp-wrap"></div>

  <!-- PRINT ROOT (PDF render) -->
  <div id="print-root"></div>

  <script>
    const App = {
      // -------------------------
      // STATE (persisted)
      // -------------------------
      state: {
        user: {
          name: "Aliko D.",
          email: "aliko.d@example.com",
          phone: "+234 800 000 0000",
          tier: 5,
          clientId: "AMADA-CL-000981",
          avatar: "https://i.pravatar.cc/150?img=11",
          notif: { yield: true, drops: true, quiet: true }
        },
        wallet: [3],
        activity: []
      },

      data: {
        tierContent: {
          1: { title: "Digital Direct", desc: "Seamless online checkout. Instant digital deed transfer.", icon: "fa-wifi" },
          2: { title: "Private Consult", desc: "Requires 20% Deposit. Dedicated Relationship Manager.", icon: "fa-user-clock" },
          3: { title: "Priority Access", desc: "Requires 5% Deposit. Early access to unlisted assets.", icon: "fa-star" },
          4: { title: "Mobile Estate", desc: "We come to you. Luxury van dispatch for private verification.", icon: "fa-shuttle-van" },
          5: { title: "Protocol ONCE", desc: "Own Nothing. Control Everything. The Private Chamber.", icon: "fa-fingerprint" }
        },
        products: [
          { id: 1, title: "The Azure Coast Estate", price: 120000000, type: "Rare Earth", tier: 3, status: "Available", location: "Eko Atlantic, Lagos", code: "AZR-COAST-031", featured: 10, createdAt: 1735600000000, img: "https://images.unsplash.com/photo-1599643478518-17488fbbcd75?q=80&w=1000", desc: "A rare combination of a 5ct Sapphire necklace and a prime waterfront plot." },
          { id: 2, title: "Amada Tech Hub Series A", price: 50000000, type: "Investment", tier: 3, status: "Available", location: "Ikoyi, Lagos", code: "ATH-SER-A-113", featured: 7, createdAt: 1736200000000, img: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=1000", desc: "Investment tier asset. Platinum band granting Series A equity exposure." },
          { id: 3, title: "Sovereign Ruby 9ct", price: 850000000, type: "Rare Earth", tier: 4, status: "Available", location: "Maitama, Abuja", code: "SVR-RBY-904", featured: 9, createdAt: 1734500000000, img: "https://images.unsplash.com/photo-1615655406736-b37c4fabf923?q=80&w=1000", desc: "Pigeon Blood Ruby paired with a title deed for a 4-bedroom terrace." },
          { id: 4, title: "Gold Coast Bond", price: 15000000, type: "Investment", tier: 2, status: "Available", location: "Victoria Island, Lagos", code: "GLD-BND-022", featured: 6, createdAt: 1735000000000, img: "https://images.unsplash.com/photo-1610375461246-83df859d849d?q=80&w=1000", desc: "Entry-level investment bond backed by gold bullion reserves." },
          { id: 5, title: "Onyx Tower Penthouse", price: 2500000000, type: "Rare Earth", tier: 5, status: "Quiet", location: "Banana Island, Lagos", code: "ONY-PENT-500", featured: 12, createdAt: 1736600000000, img: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1000", desc: "Ultra-luxury penthouse ownership represented by Black Onyx. Quiet allocation." },
          { id: 6, title: "Emerald Valley Land", price: 75000000, type: "Rare Earth", tier: 3, status: "Available", location: "Asokoro, Abuja", code: "EMR-VAL-303", featured: 5, createdAt: 1736100000000, img: "https://images.unsplash.com/photo-1598560917505-59c367dfd28b?q=80&w=1000", desc: "3 hectares in the Green Zone, paired with Emerald cufflinks." },
          { id: 7, title: "Agri-Tech Venture Yield", price: 30000000, type: "Investment", tier: 2, status: "Available", location: "Kaduna Growth Corridor", code: "AGR-YLD-210", featured: 4, createdAt: 1735900000000, img: "https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?q=80&w=1000", desc: "High-yield agricultural investment portfolio with quarterly distribution." },
          { id: 8, title: "The Royal Diamond", price: 5000000000, type: "Rare Earth", tier: 5, status: "Quiet", location: "Private Island Title", code: "ROY-DIA-999", featured: 15, createdAt: 1736700000000, img: "https://images.unsplash.com/photo-1600607686527-6fb886090705?q=80&w=1000", desc: "The pinnacle. 20ct Diamond and a private island deed. Quiet allocation." },
          { id: 9, title: "Crown Quartz Parcel", price: 100000, type: "Rare Earth", tier: 1, status: "Available", location: "Ibeju-Lekki, Lagos", code: "QRZ-PRCL-001", featured: 3, createdAt: 1735400000000, img: "https://images.unsplash.com/photo-1601121141461-9d664d6b1f72?q=80&w=1000", desc: "Micro-ownership entry with a quartz charm and deed token." },
          { id: 10, title: "Aurum Growth Note", price: 10000000, type: "Investment", tier: 2, status: "Available", location: "Lagos Financial District", code: "AUR-NOTE-010", featured: 8, createdAt: 1736350000000, img: "https://images.unsplash.com/photo-1554224154-22dec7ec8818?q=80&w=1000", desc: "Structured note designed for conservative growth with premium documentation." }
        ]
      },

      // -------------------------
      // INIT
      // -------------------------
      init() {
        this.restore();
        this.setupLoader();
        this.updateTier(1);

        // Public + Dashboard renders
        this.renderPublicShop();
        this.renderMarketplace();
        this.renderWallet();
        this.renderDocumentsHub();
        this.refreshUserUI();
        this.recalcOverviewNumbers();

        // Charts init once dashboard opens
        window.chartsInitialized = false;

        // Seed activity
        if (!this.state.activity.length) {
          this.logActivity("Vault Initialized", "Secure environment established.");
          this.logActivity("Quiet Drops", "Tier-gated inventory now rotating.");
        } else {
          this.renderActivity();
        }

        // Social proof + SEO json-ld
        this.startSocialProof();
        this.injectSEOJsonLD();

        // Quiet window timer
        this.startQuietWindowTimer();
      },

      setupLoader() {
        window.addEventListener("load", () => {
          setTimeout(() => {
            const loader = document.getElementById("loader");
            loader.style.opacity = "0";
            setTimeout(() => (loader.style.display = "none"), 1000);
          }, 1200);
        });
      },

      // -------------------------
      // PERSISTENCE
      // -------------------------
      persist() {
        localStorage.setItem("amada_state_v1", JSON.stringify(this.state));
      },
      restore() {
        try {
          const raw = localStorage.getItem("amada_state_v1");
          if (!raw) return;
          const parsed = JSON.parse(raw);
          // minimal validation
          if (parsed && parsed.user && Array.isArray(parsed.wallet)) {
            this.state = parsed;
          }
        } catch (_) {}
      },

      // -------------------------
      // HELPERS
      // -------------------------
      escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      },
      formatMoney(n) {
        const v = Number(n || 0);
        return "₦" + v.toLocaleString();
      },
      tierName(tier) {
        return ({ 1: "Entry", 2: "Consult", 3: "Priority", 4: "Mobile", 5: "ONCE" })[tier] || "—";
      },

      // -------------------------
      // USER UI
      // -------------------------
      refreshUserUI() {
        const u = this.state.user;
        document.getElementById("sidebar-name").innerText = u.name;
        document.getElementById("sidebar-tier").innerText = `Tier: ${this.tierName(u.tier)}`;

        document.getElementById("sidebar-avatar").src = u.avatar;
        document.getElementById("settings-avatar").src = u.avatar;

        document.getElementById("settings-name-title").innerText = u.name;
        document.getElementById("settings-email-title").innerText = u.email;

        document.getElementById("settings-name").value = u.name;
        document.getElementById("settings-email").value = u.email;
        document.getElementById("settings-phone").value = u.phone;
        document.getElementById("settings-tier").value = String(u.tier);

        document.getElementById("notif-yield").checked = !!u.notif.yield;
        document.getElementById("notif-drops").checked = !!u.notif.drops;
        document.getElementById("notif-quiet").checked = !!u.notif.quiet;
      },

      saveSettings() {
        const u = this.state.user;
        u.name = document.getElementById("settings-name").value.trim() || u.name;
        u.email = document.getElementById("settings-email").value.trim() || u.email;
        u.phone = document.getElementById("settings-phone").value.trim() || u.phone;
        u.tier = Number(document.getElementById("settings-tier").value) || u.tier;
        u.notif.yield = document.getElementById("notif-yield").checked;
        u.notif.drops = document.getElementById("notif-drops").checked;
        u.notif.quiet = document.getElementById("notif-quiet").checked;

        this.persist();
        this.refreshUserUI();
        this.renderMarketplace(); // tier rules affect visibility
        this.renderDocumentsHub();
        this.recalcOverviewNumbers();

        this.showToast("Settings Saved", "Profile updated successfully.", "success");
        this.logActivity("Profile Updated", `Tier set to ${this.tierName(u.tier)}.`);
      },

      onTierChangeFromSettings() {
        const tier = Number(document.getElementById("settings-tier").value);
        this.showToast("Tier", `Visibility will adjust to Tier ${tier}.`, "info");
      },

      randomizeAvatar() {
        const imgId = Math.floor(1 + Math.random() * 60);
        this.state.user.avatar = `https://i.pravatar.cc/150?img=${imgId}`;
        this.persist();
        this.refreshUserUI();
        this.showToast("Avatar", "Profile portrait updated.", "success");
      },

      // -------------------------
      // TIERS (PUBLIC)
      // -------------------------
      setTier(val) {
        document.getElementById("tier-slider").value = val;
        this.updateTier(val);
      },

      updateTier(val) {
        val = Number(val);
        const data = this.data.tierContent[val];
        const display = document.getElementById("tier-display");

        display.innerHTML = `
          <div class="text-center md:text-left animate-fade-in">
            <div class="w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-6 text-2xl mx-auto md:mx-0 ${val == 5 ? "bg-black text-white" : "text-gold-600"}">
              <i class="fas ${data.icon}"></i>
            </div>
            <h3 class="font-display text-4xl mb-4 text-gray-900">${this.escapeHtml(data.title)}</h3>
            <p class="text-gray-500 text-lg mb-6 leading-relaxed">${this.escapeHtml(data.desc)}</p>

            ${val > 1
              ? `<div class="inline-block px-4 py-2 border border-red-200 bg-red-50 text-red-500 text-xs font-bold uppercase tracking-widest rounded mb-6">Deposit Required</div><br>`
              : `<div class="inline-block px-4 py-2 border border-green-200 bg-green-50 text-green-700 text-xs font-bold uppercase tracking-widest rounded mb-6">Instant Checkout Enabled</div><br>`
            }

            <button onclick="App.handleTierAction(${val})" class="px-8 py-4 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-500 transition shadow-lg transform hover:scale-105">
              ${val === 5 ? "Initiate Protocol" : "Select Tier"}
            </button>
          </div>

          <div class="hidden md:block h-[300px] bg-gray-100 rounded-3xl relative overflow-hidden animate-fade-in shadow-inner">
            <div class="absolute inset-0 flex items-center justify-center text-gray-300"><i class="fas fa-layer-group text-9xl opacity-20"></i></div>

            <div class="absolute top-6 left-6 right-6 flex items-center justify-between">
              <span class="pill bg-white/80 border border-white text-gray-800"><i class="fas fa-shield-halved text-gold-600"></i> Verified flow</span>
              <span class="pill bg-black text-white"><i class="fas fa-crown text-gold-400"></i> Tier ${val}/5</span>
            </div>

            <div class="absolute bottom-6 left-6 right-6 bg-white/80 backdrop-blur p-4 rounded-xl">
              <div class="flex justify-between items-center">
                <span class="text-xs font-bold uppercase text-gray-500">Service Level</span>
                <span class="text-gold-600 font-display font-bold text-xl">${val}/5</span>
              </div>
              <div class="w-full bg-gray-200 h-1 mt-2 rounded-full overflow-hidden">
                <div class="bg-gold-500 h-full transition-all duration-500" style="width: ${val * 20}%"></div>
              </div>
            </div>
          </div>
        `;
      },

      handleTierAction(tier) {
        if (tier === 1) this.openDashboard("marketplace");
        else {
          this.showToast("Authentication", "Redirecting to secure deposit gateway...", "info");
          setTimeout(() => this.openDashboard("overview"), 900);
          this.logActivity("Deposit Route", `Tier ${tier} selected. Secure gateway simulated.`);
        }
      },

      // -------------------------
      // DASHBOARD CORE
      // -------------------------
      openDashboard(tab = "overview") {
        const dashboard = document.getElementById("dashboard-os");
        dashboard.classList.remove("translate-y-full");
        document.body.style.overflow = "hidden";

        if (!window.chartsInitialized) {
          this.initCharts();
          window.chartsInitialized = true;
        }
        this.switchTab(tab);
        this.startSocialProof();
        this.showQuietPill(true);
      },

      closeDashboard() {
        document.getElementById("dashboard-os").classList.add("translate-y-full");
        document.body.style.overflow = "";
        this.startSocialProof(); // keep on public
        this.showQuietPill(false);
      },

      switchTab(tab) {
        document.querySelectorAll(".nav-item").forEach((el) => el.classList.remove("active"));
        const btn = document.querySelector(`button[onclick="App.switchTab('${tab}')"]`);
        if (btn) btn.classList.add("active");

        document.querySelectorAll(".tab-content").forEach((el) => el.classList.add("hidden"));
        const content = document.getElementById(`tab-${tab}`);
        if (content) {
          content.classList.remove("hidden");
          content.classList.remove("animate-slide-up");
          void content.offsetWidth;
          content.classList.add("animate-slide-up");
        }

        const titles = {
          overview: "Portfolio Overview",
          wallet: "My Asset Wallet",
          marketplace: "Asset Marketplace",
          concierge: "Private Concierge",
          documents: "Legal Repository",
          settings: "Account Settings",
        };
        document.getElementById("page-title").innerText = titles[tab] || "Dashboard";

        // Social proof strongest in these
        if (["marketplace", "overview", "documents"].includes(tab)) this.startSocialProof();
        else this.stopSocialProof();
      },

      // -------------------------
      // SHOP FILTER (robust)
      // -------------------------
      setShopTier(val, fromSlider = false) {
        val = Number(val);
        const slider = document.getElementById("shop-tier-slider");
        const label = document.getElementById("shop-tier-label");
        if (!fromSlider) slider.value = val;
        label.innerText = String(val);
        this.filterShop();
      },

      resetShopFilters() {
        document.getElementById("shop-search").value = "";
        document.getElementById("shop-sort").value = "default";
        document.getElementById("shop-filter-type").value = "all";
        document.getElementById("shop-availability").value = "all";
        document.getElementById("shop-tier-slider").value = "5";
        document.getElementById("shop-tier-label").innerText = "5";
        this.filterShop();
        this.showToast("Filters", "Marketplace filters reset.", "success");
      },

      filterShop() {
        const search = document.getElementById("shop-search").value.toLowerCase();
        const type = document.getElementById("shop-filter-type").value;
        const sort = document.getElementById("shop-sort").value;
        const availability = document.getElementById("shop-availability").value;
        const tierLimit = Number(document.getElementById("shop-tier-slider").value || 5);

        // Tier gating rule: user's tier caps visibility (unless tier 5 sees all)
        const userTier = Number(this.state.user.tier || 1);

        let filtered = this.data.products.filter((p) => {
          const matchSearch =
            p.title.toLowerCase().includes(search) ||
            p.desc.toLowerCase().includes(search) ||
            p.location.toLowerCase().includes(search) ||
            String(p.code).toLowerCase().includes(search);

          const matchType = type === "all" || p.type === type;
          const matchAvailability = availability === "all" || p.status === availability;

          // user tier gating: must be <= userTier
          const matchUserTier = p.tier <= userTier;

          // slider tier filter: must be <= tierLimit
          const matchTierLimit = p.tier <= tierLimit;

          // quiet items: only show if userTier >= 4 (or tier 5)
          const quietAllowed = (p.status !== "Quiet") || userTier >= 4;

          return matchSearch && matchType && matchAvailability && matchUserTier && matchTierLimit && quietAllowed;
        });

        if (sort === "price-asc") filtered.sort((a, b) => a.price - b.price);
        if (sort === "price-desc") filtered.sort((a, b) => b.price - a.price);
        if (sort === "newest") filtered.sort((a, b) => b.createdAt - a.createdAt);
        if (sort === "default") filtered.sort((a, b) => (b.featured || 0) - (a.featured || 0));

        this.renderMarketplace(filtered);

        // visible count
        const visibleCount = filtered.length;
        document.getElementById("shop-visible-count").innerText = `${visibleCount} visible`;

        return filtered;
      },

      renderPublicShop() {
        const grid = document.getElementById("public-products-grid");
        const top = [...this.data.products].sort((a, b) => (b.featured || 0) - (a.featured || 0)).slice(0, 3);
        grid.innerHTML = top.map((p) => this.createProductCard(p, { compact: true })).join("");
      },

      renderMarketplace(items = null) {
        const grid = document.getElementById("marketplace-grid");
        const noResults = document.getElementById("no-results");
        const userTier = Number(this.state.user.tier || 1);

        // default items should respect user tier gate too
        const base = items || this.data.products;
        const gated = base.filter((p) => {
          const matchUserTier = p.tier <= userTier;
          const quietAllowed = (p.status !== "Quiet") || userTier >= 4;
          return matchUserTier && quietAllowed;
        });

        if (gated.length === 0) {
          grid.innerHTML = "";
          noResults.classList.remove("hidden");
        } else {
          noResults.classList.add("hidden");
          grid.innerHTML = gated.map((p) => this.createProductCard(p)).join("");
        }
      },

      createProductCard(p, opts = {}) {
        const owned = this.state.wallet.includes(p.id);
        const statusBadge =
          p.status === "Quiet"
            ? `<div class="absolute top-2 left-2 bg-black/85 text-white px-2 py-1 rounded text-[10px] font-bold uppercase"><i class="fas fa-lock mr-1 text-gold-300"></i> Quiet</div>`
            : `<div class="absolute top-2 left-2 bg-white/90 px-2 py-1 rounded text-[10px] font-bold uppercase"><i class="fas fa-circle mr-1 text-green-500"></i> Available</div>`;

        const ownedBadge = owned
          ? `<div class="absolute top-2 right-2 bg-gold-500/90 text-white px-2 py-1 rounded text-[10px] font-bold uppercase"><i class="fas fa-check mr-1"></i> Owned</div>`
          : `<div class="absolute top-2 right-2 bg-white/90 px-2 py-1 rounded text-[10px] font-bold uppercase">${this.escapeHtml(p.type)}</div>`;

        const tierChip = `<div class="absolute bottom-2 left-2 pill bg-white/85 border border-white text-gray-800"><i class="fas fa-crown text-gold-600"></i> Tier ${p.tier}</div>`;

        return `
          <div class="glass-card p-4 hover:shadow-xl transition duration-300 group cursor-pointer bg-white h-full flex flex-col" onclick="App.showProductModal(${p.id})">
            <div class="h-48 rounded-xl overflow-hidden mb-4 relative flex-shrink-0">
              <img src="${this.escapeHtml(p.img)}" class="w-full h-full object-cover transition duration-700 group-hover:scale-110" alt="${this.escapeHtml(p.title)}">
              ${statusBadge}
              ${ownedBadge}
              ${tierChip}
            </div>
            <div class="flex-1 flex flex-col">
              <h4 class="font-display font-bold text-lg mb-1 leading-tight">${this.escapeHtml(p.title)}</h4>
              <p class="text-xs text-gray-500 mb-2">${this.escapeHtml(p.location)} • <span class="mono">${this.escapeHtml(p.code)}</span></p>
              <p class="text-xs text-gray-500 mb-3 line-clamp-2">${this.escapeHtml(p.desc)}</p>

              <div class="mt-auto flex justify-between items-center pt-2 border-t border-gray-100">
                <span class="text-gold-600 font-bold text-sm">${this.formatMoney(p.price)}</span>
                <button class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-black hover:text-white transition" title="Open">
                  <i class="fas fa-arrow-right text-xs"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      },

      // -------------------------
      // MODAL + ACQUIRE
      // -------------------------
      showProductModal(id) {
        const p = this.data.products.find((x) => x.id === id);
        if (!p) return;
        this.currentProductId = id;

        const statusText = p.status === "Quiet" ? "Quiet (Limited)" : "Available";
        const statusColor = p.status === "Quiet" ? "text-gray-900" : "text-green-600";
        const fomo = this.buildFomoLine(p);

        document.getElementById("modal-title").innerText = p.title;
        document.getElementById("modal-price").innerText = this.formatMoney(p.price);
        document.getElementById("modal-type").innerText = p.type;
        document.getElementById("modal-desc").innerText = p.desc;
        document.getElementById("modal-img").src = p.img;

        document.getElementById("modal-location").innerText = p.location;
        document.getElementById("modal-location-2").innerText = p.location;
        document.getElementById("modal-status").innerText = statusText;
        document.getElementById("modal-status").className = `font-medium ${statusColor}`;
        document.getElementById("modal-code").innerText = p.code;
        document.getElementById("modal-tier").innerText = `Tier ${p.tier} (${this.tierName(p.tier)})`;

        // badges
        document.getElementById("modal-status-badge").innerHTML =
          p.status === "Quiet"
            ? `<i class="fas fa-lock text-gold-600"></i> <span>Quiet</span>`
            : `<i class="fas fa-circle text-green-500"></i> <span>Available</span>`;
        document.getElementById("modal-tier-badge").innerHTML = `<i class="fas fa-crown text-gold-400"></i> <span>Tier ${p.tier}</span>`;

        document.getElementById("modal-fomo").innerText = fomo;

        // gate secure button if user tier too low or quiet and tier < 4
        const userTier = Number(this.state.user.tier || 1);
        const owned = this.state.wallet.includes(p.id);
        const secureBtn = document.getElementById("modal-secure-btn");

        if (owned) {
          secureBtn.disabled = true;
          secureBtn.className = secureBtn.className.replace("bg-black", "bg-gray-200").replace("text-white", "text-gray-500");
          secureBtn.innerText = "Already Owned";
        } else if (p.tier > userTier) {
          secureBtn.disabled = true;
          secureBtn.className = secureBtn.className.replace("bg-black", "bg-gray-200").replace("text-white", "text-gray-500");
          secureBtn.innerText = `Tier Locked (Requires Tier ${p.tier})`;
        } else if (p.status === "Quiet" && userTier < 4) {
          secureBtn.disabled = true;
          secureBtn.className = secureBtn.className.replace("bg-black", "bg-gray-200").replace("text-white", "text-gray-500");
          secureBtn.innerText = "Quiet Allocation (Tier 4+)";
        } else {
          secureBtn.disabled = false;
          secureBtn.className = "w-full py-4 bg-black text-white rounded-xl font-bold uppercase tracking-widest text-xs hover:bg-gold-500 transition shadow-lg mb-3";
          secureBtn.innerText = "Secure Asset";
        }

        const modal = document.getElementById("product-modal");
        const panel = document.getElementById("product-modal-panel");
        modal.classList.remove("hidden");
        setTimeout(() => panel.classList.remove("translate-x-full"), 10);

        this.logActivity("Asset Viewed", `${p.title} • ${this.formatMoney(p.price)}`);
      },

      closeProductModal() {
        const modal = document.getElementById("product-modal");
        const panel = document.getElementById("product-modal-panel");
        panel.classList.add("translate-x-full");
        setTimeout(() => modal.classList.add("hidden"), 300);
      },

      addToWalletFromModal() {
        this.addToWallet(this.currentProductId);
      },

      addToWallet(id) {
        const p = this.data.products.find((x) => x.id === id);
        if (!p) return;

        if (this.state.wallet.includes(id)) {
          this.showToast("Error", "You already own this asset.", "error");
          return;
        }

        // gate checks
        const userTier = Number(this.state.user.tier || 1);
        if (p.tier > userTier) {
          this.showToast("Tier Locked", `Requires Tier ${p.tier} to secure this.`, "error");
          return;
        }
        if (p.status === "Quiet" && userTier < 4) {
          this.showToast("Quiet Allocation", "Tier 4+ required for quiet allocations.", "error");
          return;
        }

        this.showToast("Processing", "Securing asset on ledger...", "info");

        setTimeout(() => {
          this.state.wallet.push(id);
          this.persist();

          this.renderWallet();
          this.renderDocumentsHub();
          this.recalcOverviewNumbers();

          const txnId = "TXN-" + Math.random().toString(36).slice(2, 10).toUpperCase();

          this.logActivity("Asset Secured", `${p.title} • ${this.formatMoney(p.price)} • ${txnId}`);
          this.showToast("Success", "Asset acquired successfully.", "success");
          this.closeProductModal();
          this.switchTab("wallet");

          // auto-generate a receipt PDF as part of the psychological “completion”
          this.downloadLuxuryPDF("Receipt", id, { txnId, method: "Private Gateway (Demo)" });
        }, 900);
      },

      previewDocsFromModal() {
        const id = this.currentProductId;
        const p = this.data.products.find((x) => x.id === id);
        if (!p) return;

        // If not owned, still allow preview pack as “presentation”
        this.showToast("Vault", "Preparing document pack...", "info");
        setTimeout(async () => {
          await this.downloadLuxuryPDF("Certificate", id);
          await this.downloadLuxuryPDF("Authenticity", id);
          // Deed is usually post-acquisition; still allow preview for demo:
          await this.downloadLuxuryPDF("Deed", id);
          this.logActivity("Document Pack", `Generated pack for ${p.title}.`);
        }, 350);
      },

      buildFomoLine(p) {
        const watchers = Math.floor(3 + Math.random() * 18);
        const left = Math.max(1, Math.floor(1 + Math.random() * 4));
        const mins = [1,2,3,4,7,11,14][Math.floor(Math.random()*7)];
        const parts = [
          `${watchers} elite clients are viewing this.`,
          `Last secured: ${mins} min ago.`,
          `Only ${left} allocation${left>1?"s":""} left.`,
          `Price re-evaluates soon.`
        ];
        // quiet makes it more intense
        if (p.status === "Quiet") parts.unshift("Quiet mode: visibility can vanish without notice.");
        return parts.join(" ");
      },

      // -------------------------
      // WALLET + DOCUMENT HUB
      // -------------------------
      renderWallet() {
        const grid = document.getElementById("wallet-grid");
        const myItems = this.data.products.filter((p) => this.state.wallet.includes(p.id));

        if (!myItems.length) {
          grid.innerHTML = `
            <div class="mac-window p-10 text-center col-span-1 md:col-span-2">
              <div class="w-14 h-14 rounded-2xl bg-gray-100 mx-auto flex items-center justify-center text-gray-400 mb-4"><i class="fas fa-wallet text-2xl"></i></div>
              <h3 class="font-display text-2xl mb-2">No assets yet.</h3>
              <p class="text-gray-500 mb-6">Secure your first asset to unlock the full deed + certificate vault.</p>
              <button onclick="App.switchTab('marketplace')" class="px-6 py-3 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">Enter Marketplace</button>
            </div>
          `;
          return;
        }

        grid.innerHTML = myItems.map((p) => `
          <div class="mac-window p-6 flex flex-col gap-6">
            <div class="flex items-center gap-4">
              <div class="w-20 h-20 rounded-2xl overflow-hidden bg-gray-200 flex-shrink-0">
                <img src="${this.escapeHtml(p.img)}" class="w-full h-full object-cover" alt="${this.escapeHtml(p.title)}">
              </div>
              <div class="flex-1">
                <div class="flex items-center gap-2">
                  <h3 class="font-display font-bold text-xl">${this.escapeHtml(p.title)}</h3>
                  <i class="fas fa-check-circle text-gold-500" title="Verified Owner"></i>
                </div>
                <p class="text-sm text-gray-500 mt-1">${this.escapeHtml(p.location)} • <span class="mono">${this.escapeHtml(p.code)}</span></p>
                <p class="text-sm text-gray-600 mt-2">Valuation: <b>${this.formatMoney(p.price)}</b> • Tier ${p.tier} (${this.tierName(p.tier)})</p>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-3">
              <button onclick="App.downloadLuxuryPDF('Certificate', ${p.id})" class="px-4 py-3 bg-black text-white rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">Certificate</button>
              <button onclick="App.downloadLuxuryPDF('Deed', ${p.id})" class="px-4 py-3 bg-white border border-gray-200 rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-gray-100 transition">Deed</button>
              <button onclick="App.downloadLuxuryPDF('Authenticity', ${p.id})" class="px-4 py-3 bg-white border border-gray-200 rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-gray-100 transition">Authenticity</button>
              <button onclick="App.downloadLuxuryPDF('Receipt', ${p.id}, { txnId: App.newTxnId(), method: 'Vault Reprint (Demo)' })" class="px-4 py-3 bg-white border border-gray-200 rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-gray-100 transition">Receipt</button>
            </div>

            <div class="flex justify-between items-center text-xs uppercase tracking-widest text-gray-400">
              <span>Vault stamp ready</span>
              <button onclick="App.showProductModal(${p.id})" class="text-gold-700 font-bold hover:text-gold-600">Open Asset</button>
            </div>
          </div>
        `).join("");
      },

      renderDocumentsHub() {
        const grid = document.getElementById("documents-grid");
        const myItems = this.data.products.filter((p) => this.state.wallet.includes(p.id));

        const staticDocs = [
          { title: "NDA — ONCE Protocol", meta: "PDF • Signed (Demo)", icon: "fa-file-contract", color: "text-blue-600", bg: "bg-blue-50", action: () => this.exportStaticDoc("NDA") },
          { title: "Security Policy — Vault Handling", meta: "PDF • Current (Demo)", icon: "fa-shield-halved", color: "text-green-700", bg: "bg-green-50", action: () => this.exportStaticDoc("Security Policy") },
          { title: "Ledger Verification Guide", meta: "PDF • Reference (Demo)", icon: "fa-file-lines", color: "text-gray-700", bg: "bg-gray-100", action: () => this.exportStaticDoc("Verification Guide") }
        ];

        const ownedCards = myItems.map((p) => `
          <div class="mac-window p-5 hover:bg-white transition">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-red-50 text-red-500 rounded-xl flex items-center justify-center text-2xl"><i class="fas fa-file-pdf"></i></div>
              <div class="flex-1">
                <h4 class="font-bold text-gray-900">${this.escapeHtml(p.title)} — Document Pack</h4>
                <p class="text-xs text-gray-500 mt-1">${this.escapeHtml(p.location)} • Tier ${p.tier} • ${this.formatMoney(p.price)}</p>
                <div class="flex flex-wrap gap-2 mt-4">
                  <button onclick="App.downloadLuxuryPDF('Certificate', ${p.id})" class="px-3 py-2 bg-black text-white rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-gold-600 transition">Certificate</button>
                  <button onclick="App.downloadLuxuryPDF('Deed', ${p.id})" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-gray-100 transition">Deed</button>
                  <button onclick="App.downloadLuxuryPDF('Authenticity', ${p.id})" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-gray-100 transition">Authenticity</button>
                  <button onclick="App.downloadLuxuryPDF('Receipt', ${p.id}, { txnId: App.newTxnId(), method: 'Vault Reprint (Demo)' })" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[10px] font-bold uppercase tracking-widest hover:bg-gray-100 transition">Receipt</button>
                </div>
              </div>
            </div>
          </div>
        `).join("");

        const staticCards = staticDocs.map((d) => `
          <div class="mac-window p-5 hover:bg-white transition cursor-pointer" onclick="(${d.action.toString()})()">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 ${d.bg} ${d.color} rounded-xl flex items-center justify-center text-2xl"><i class="fas ${d.icon}"></i></div>
              <div class="flex-1">
                <h4 class="font-bold text-gray-900">${this.escapeHtml(d.title)}</h4>
                <p class="text-xs text-gray-500 mt-1">${this.escapeHtml(d.meta)}</p>
                <p class="text-xs text-gray-400 mt-3 uppercase tracking-widest">Click to export PDF</p>
              </div>
              <div class="text-gray-400"><i class="fas fa-download"></i></div>
            </div>
          </div>
        `).join("");

        grid.innerHTML = ownedCards + staticCards;

        if (!myItems.length) {
          grid.innerHTML = `
            <div class="mac-window p-10 text-center col-span-1 md:col-span-2">
              <div class="w-14 h-14 rounded-2xl bg-gray-100 mx-auto flex items-center justify-center text-gray-400 mb-4"><i class="fas fa-file-contract text-2xl"></i></div>
              <h3 class="font-display text-2xl mb-2">Vault is empty.</h3>
              <p class="text-gray-500 mb-6">Secure your first asset to unlock deed-backed documents.</p>
              <button onclick="App.switchTab('marketplace')" class="px-6 py-3 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gold-600 transition">Enter Marketplace</button>
            </div>
          ` + staticCards;
        }
      },

      newTxnId() {
        return "TXN-" + Math.random().toString(36).slice(2, 10).toUpperCase();
      },

      verifyDocPrompt() {
        const code = prompt("Enter Document ID (e.g., AMADA-CERT-000003):");
        if (!code) return;
        // Simulated verification
        this.showToast("Verified", `Document ${code} verified (demo).`, "success");
        this.logActivity("Document Verified", `Verified ${code}`);
      },

      exportPortfolioStatement() {
        // create a pseudo product to bind statement
        const total = this.computeWalletTotals().total;
        const tmp = {
          id: 999999,
          title: "Portfolio Statement",
          price: total,
          type: "Statement",
          tier: this.state.user.tier,
          status: "Available",
          location: "Amada Vault",
          code: "STATEMENT-PORTFOLIO",
          desc: "A portfolio statement summarizing owned assets and current valuations."
        };
        // temporarily inject into doc generator
        const original = this.data.products.find((x) => x.id === 999999);
        if (!original) this.data.products.push(tmp);
        this.downloadLuxuryPDF("Certificate", 999999, { overrideTitle: "Portfolio Statement" })
          .then(() => {
            this.logActivity("Portfolio Statement", `Exported statement • ${this.formatMoney(total)}`);
            // cleanup
            this.data.products = this.data.products.filter((x) => x.id !== 999999);
          });
      },

      exportStaticDoc(title) {
        // generate a PDF using the luxury template but with a pseudo "asset"
        const tmpId = 999998;
        const tmp = {
          id: tmpId,
          title: title,
          price: 0,
          type: "Policy",
          tier: this.state.user.tier,
          status: "Available",
          location: "Amada Vault",
          code: "DOC-" + title.toUpperCase().replace(/\s+/g, "-"),
          desc: "A premium documentation export for internal use (demo)."
        };
        this.data.products = this.data.products.filter((x) => x.id !== tmpId);
        this.data.products.push(tmp);

        this.downloadLuxuryPDF("Authenticity", tmpId, { overrideTitle: title })
          .then(() => {
            this.logActivity("Policy Exported", title);
            this.data.products = this.data.products.filter((x) => x.id !== tmpId);
          });
      },

      // -------------------------
      // TOAST
      // -------------------------
      showToast(title, msg, type = "success") {
        const toast = document.getElementById("toast");
        const icon = document.getElementById("toast-icon");

        const map = {
          success: { bg: "bg-green-100", text: "text-green-600", ico: "fa-check" },
          error: { bg: "bg-red-100", text: "text-red-600", ico: "fa-times" },
          info: { bg: "bg-blue-100", text: "text-blue-600", ico: "fa-info" },
          warn: { bg: "bg-yellow-100", text: "text-yellow-700", ico: "fa-triangle-exclamation" }
        };
        const s = map[type] || map.success;

        icon.className = `w-10 h-10 rounded-full ${s.bg} ${s.text} flex items-center justify-center`;
        icon.innerHTML = `<i class="fas ${s.ico}"></i>`;

        toast.querySelector("h4").innerText = title;
        toast.querySelector("p").innerText = msg;

        toast.classList.remove("translate-x-[200%]");
        setTimeout(() => toast.classList.add("translate-x-[200%]"), 3200);
      },

      // -------------------------
      // CHAT
      // -------------------------
      sendMessage() {
        const input = document.getElementById("chat-input");
        const text = input.value.trim();
        if (!text) return;

        const history = document.getElementById("chat-history");
        history.innerHTML += `
          <div class="flex items-start gap-3 flex-row-reverse animate-slide-up">
            <div class="bg-black text-white p-3 rounded-2xl rounded-tr-none max-w-[80%] text-sm">${this.escapeHtml(text)}</div>
          </div>
        `;
        input.value = "";
        history.scrollTop = history.scrollHeight;

        this.logActivity("Concierge Message", text);

        setTimeout(() => {
          const reply = this.conciergeReply(text);
          history.innerHTML += `
            <div class="flex items-start gap-3 animate-slide-up">
              <div class="w-8 h-8 rounded-full bg-gold-500 text-white flex-shrink-0 flex items-center justify-center text-xs"><i class="fas fa-user-tie"></i></div>
              <div class="bg-gray-100 p-3 rounded-2xl rounded-tl-none max-w-[80%] text-sm">${this.escapeHtml(reply)}</div>
            </div>
          `;
          history.scrollTop = history.scrollHeight;
        }, 850);
      },

      conciergeReply(text) {
        const t = text.toLowerCase();
        if (t.includes("quiet transfer")) return "Understood. Quiet transfer initiated (demo). Please confirm the recipient identity code.";
        if (t.includes("deed") || t.includes("certificate")) return "Your vault can export the full pack instantly. If you want a stamped presentation copy, say: “presentation stamp”.";
        if (t.includes("tier")) return "Tier visibility is enforced. If you want ONCE-only drops, your profile must be Tier 5.";
        return "Noted. Your request is being routed to a specialist now (demo).";
      },

      // -------------------------
      // ACTIVITY FEED
      // -------------------------
      logActivity(title, detail) {
        const item = {
          ts: Date.now(),
          title: String(title),
          detail: String(detail)
        };
        this.state.activity.unshift(item);
        this.state.activity = this.state.activity.slice(0, 20);
        this.persist();
        this.renderActivity();
      },

      renderActivity() {
        const el = document.getElementById("activity-feed");
        if (!el) return;

        el.innerHTML = this.state.activity.map((a) => {
          const time = new Date(a.ts).toLocaleString();
          return `
            <div class="flex items-start gap-3 p-3 rounded-2xl bg-white/70 border border-white">
              <div class="w-10 h-10 rounded-2xl bg-black text-gold-400 flex items-center justify-center flex-shrink-0"><i class="fas fa-bolt"></i></div>
              <div class="flex-1">
                <div class="flex items-center justify-between gap-4">
                  <p class="font-bold text-sm text-gray-900">${this.escapeHtml(a.title)}</p>
                  <p class="text-[10px] uppercase tracking-widest text-gray-400">${this.escapeHtml(time)}</p>
                </div>
                <p class="text-sm text-gray-600 mt-1">${this.escapeHtml(a.detail)}</p>
              </div>
            </div>
          `;
        }).join("");
      },

      seedFomoActivity() {
        const p = this.data.products[Math.floor(Math.random() * this.data.products.length)];
        const types = [
          ["Quiet Drop", `A tier-${p.tier} asset entered quiet mode: ${p.title}`],
          ["Verification", `Certificate verified for ${p.code}`],
          ["Securing", `A private client secured ${p.title}`],
          ["Signal", `Watch count spiked for ${p.title}`],
        ];
        const [t, d] = types[Math.floor(Math.random()*types.length)];
        this.logActivity(t, d);
        this.showToast("Activity", "New ledger activity recorded.", "info");
      },

      // -------------------------
      // OVERVIEW TOTALS
      // -------------------------
      computeWalletTotals() {
        const myItems = this.data.products.filter((p) => this.state.wallet.includes(p.id));
        let total = 0, rare = 0, invest = 0;
        for (const p of myItems) {
          total += p.price;
          if (p.type === "Rare Earth") rare += p.price;
          if (p.type === "Investment") invest += p.price;
        }
        return { total, rare, invest, count: myItems.length };
      },

      recalcOverviewNumbers() {
        const { total, rare, invest } = this.computeWalletTotals();
        document.getElementById("overview-total").innerText = this.formatMoney(total || 1450000000);
        document.getElementById("overview-rare").innerText = this.formatMoney(rare || 850000000);
        document.getElementById("overview-invest").innerText = this.formatMoney(invest || 600000000);
      },

      // -------------------------
      // CHARTS
      // -------------------------
      initCharts() {
        const ctx = document.getElementById("mainChart").getContext("2d");
        const gradient = ctx.createLinearGradient(0, 0, 0, 400);
        gradient.addColorStop(0, "rgba(212, 175, 55, 0.2)");
        gradient.addColorStop(1, "rgba(255, 255, 255, 0)");

        new Chart(ctx, {
          type: "line",
          data: {
            labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
            datasets: [{
              label: "Portfolio Value",
              data: [1200, 1250, 1240, 1300, 1380, 1450],
              borderColor: "#D4AF37",
              backgroundColor: gradient,
              borderWidth: 2,
              tension: 0.4,
              fill: true
            }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
        });

        new Chart(document.getElementById("pieChart").getContext("2d"), {
          type: "doughnut",
          data: {
            labels: ["Real Estate", "Equities", "Gold"],
            datasets: [{ data: [60, 25, 15], backgroundColor: ["#111", "#D4AF37", "#e5e7eb"], borderWidth: 0 }]
          },
          options: { cutout: "75%", plugins: { legend: { position: "bottom", labels: { usePointStyle: true } } } }
        });
      },

      // -------------------------
      // SOCIAL PROOF ENGINE
      // -------------------------
      startSocialProof() {
        if (this._spTimer) return;
        const fire = () => this.spawnSocialProof();
        this._spTimer = setInterval(fire, 5200 + Math.random() * 3800);
        setTimeout(fire, 1600);
      },

      stopSocialProof() {
        if (!this._spTimer) return;
        clearInterval(this._spTimer);
        this._spTimer = null;
      },

      spawnSocialProof() {
        const container = document.getElementById("sp-container");
        if (!container) return;

        const dashboardVisible = !document.getElementById("dashboard-os").classList.contains("translate-y-full");
        const allow = dashboardVisible || document.getElementById("public-site");
        if (!allow) return;

        if (container.children.length >= 3) container.removeChild(container.lastElementChild);

        const p = this.data.products[Math.floor(Math.random() * this.data.products.length)];
        const userTier = Number(this.state.user.tier || 1);

        // Only show what user could plausibly see
        if (p.tier > userTier) return;
        if (p.status === "Quiet" && userTier < 4) return;

        const who = ["Tier 5 Client", "Private Client", "Sovereign Client", "Investor", "Founder", "Family Office"][Math.floor(Math.random() * 6)];
        const mins = [1, 2, 3, 4, 7, 11, 14][Math.floor(Math.random() * 7)];
        const watchers = Math.floor(3 + Math.random() * 18);
        const left = Math.max(1, Math.floor(1 + Math.random() * 4));

        const variants = [
          { title: "LIVE SECURING", icon: "fa-gem", msg: `${who} secured <b>${this.escapeHtml(p.title)}</b>.`, sub: `${mins} min ago • ${this.escapeHtml(p.location)} • Tier ${p.tier} (${this.tierName(p.tier)})`, chip: `Only ${left} allocation${left > 1 ? "s" : ""} left` },
          { title: "VIEWING NOW", icon: "fa-eye", msg: `<b>${watchers}</b> elite clients are viewing <b>${this.escapeHtml(p.title)}</b>.`, sub: `Private inventory • ${this.escapeHtml(p.type)} • Tier ${p.tier}+`, chip: `Price re-evaluates soon` },
          { title: "PRIVATE DROP", icon: "fa-lock", msg: `A tier-${p.tier} asset just moved to “quiet mode”.`, sub: `Discretion protocol • ${this.escapeHtml(p.location)} • limited visibility`, chip: `Claim window: ${Math.floor(6 + Math.random() * 18)}h` },
          { title: "AUTHENTICATED", icon: "fa-shield-halved", msg: `Certificate verified for <b>${this.escapeHtml(p.title)}</b>.`, sub: `Ledger stamp • Vault seal • ${this.formatMoney(p.price)}`, chip: `Documentation ready` }
        ];

        const v = variants[Math.floor(Math.random() * variants.length)];

        const card = document.createElement("div");
        card.className = "sp-card";
        card.innerHTML = `
          <div class="sp-top">
            <div class="sp-title">${v.title}</div>
            <div class="sp-close" title="Dismiss"><i class="fas fa-times"></i></div>
          </div>
          <div class="sp-body">
            <div class="sp-ico"><i class="fas ${v.icon}"></i></div>
            <div class="sp-msg">
              ${v.msg}
              <div class="sp-sub">${v.sub}</div>
              <div class="sp-chip"><i class="fas fa-bolt"></i> ${v.chip}</div>
            </div>
          </div>
        `;

        card.querySelector(".sp-close").addEventListener("click", () => {
          card.classList.add("out");
          setTimeout(() => card.remove(), 320);
        });

        container.prepend(card);

        setTimeout(() => {
          if (!card.isConnected) return;
          card.classList.add("out");
          setTimeout(() => card.remove(), 320);
        }, 4800 + Math.random() * 1800);
      },

      // -------------------------
      // QUIET WINDOW (timer)
      // -------------------------
      startQuietWindowTimer() {
        // A repeating countdown (demo psychology)
        if (this._quietTick) return;

        // random 30-90 mins
        this._quietEndsAt = Date.now() + (30 + Math.floor(Math.random() * 60)) * 60 * 1000;

        this._quietTick = setInterval(() => {
          const remaining = this._quietEndsAt - Date.now();
          if (remaining <= 0) {
            // restart
            this._quietEndsAt = Date.now() + (30 + Math.floor(Math.random() * 60)) * 60 * 1000;
            this.showToast("Quiet Window", "Inventory rotated. Visibility updated.", "warn");
            this.logActivity("Rotation", "Quiet window reset. Inventory rotated.");
            this.filterShop();
          }
          this.updateQuietPill();
        }, 1000);

        this.updateQuietPill();
      },

      showQuietPill(show) {
        const pill = document.getElementById("quiet-window-pill");
        if (!pill) return;
        if (show) pill.classList.remove("hidden");
        else pill.classList.add("hidden");
      },

      updateQuietPill() {
        const t = document.getElementById("quiet-window-text");
        if (!t) return;

        const remaining = Math.max(0, this._quietEndsAt - Date.now());
        const hh = String(Math.floor(remaining / 3600000)).padStart(2, "0");
        const mm = String(Math.floor((remaining % 3600000) / 60000)).padStart(2, "0");
        const ss = String(Math.floor((remaining % 60000) / 1000)).padStart(2, "0");
        t.innerText = `Quiet window: ${hh}:${mm}:${ss}`;
      },

      // -------------------------
      // SEO JSON-LD
      // -------------------------
      injectSEOJsonLD() {
        const old = document.getElementById("jsonld-amada");
        if (old) old.remove();

        const baseImg = "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?q=80&w=1200";

        const org = {
          "@context": "https://schema.org",
          "@type": "Organization",
          "name": "Amada Realty",
          "description": "Amada Realty fuses luxury jewelry with deed-backed ownership. Wear your assets.",
          "logo": baseImg,
          "sameAs": []
        };

        const website = {
          "@context": "https://schema.org",
          "@type": "WebSite",
          "name": "Amada Realty",
          "url": "/",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "/?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        };

        const items = this.data.products.map((p, i) => ({
          "@type": "ListItem",
          "position": i + 1,
          "item": {
            "@type": "Product",
            "name": p.title,
            "category": p.type,
            "description": p.desc,
            "offers": {
              "@type": "Offer",
              "priceCurrency": "NGN",
              "price": p.price,
              "availability": "https://schema.org/InStock"
            }
          }
        }));

        const itemList = {
          "@context": "https://schema.org",
          "@type": "ItemList",
          "name": "Amada Curated Assets",
          "itemListElement": items
        };

        const script = document.createElement("script");
        script.type = "application/ld+json";
        script.id = "jsonld-amada";
        script.textContent = JSON.stringify([org, website, itemList]);
        document.head.appendChild(script);
      },

      // -------------------------
      // LUX PDF GENERATOR
      // -------------------------
      async downloadLuxuryPDF(docType, productId, extra = {}) {
        const p0 = this.data.products.find((x) => x.id === productId);
        if (!p0) return;

        const p = { ...p0 };
        if (extra.overrideTitle) p.title = extra.overrideTitle;

        const html = this.buildLuxuryDocHTML(docType, p, extra);
        const root = document.getElementById("print-root");
        root.innerHTML = html;

        const el = root.querySelector(".doc-a4");
        await new Promise((r) => requestAnimationFrame(r));

        const canvas = await html2canvas(el, { scale: 2, useCORS: true, backgroundColor: "#ffffff" });
        const imgData = canvas.toDataURL("image/jpeg", 0.92);

        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF("p", "pt", "a4");
        const pageW = pdf.internal.pageSize.getWidth();
        const pageH = pdf.internal.pageSize.getHeight();

        pdf.addImage(imgData, "JPEG", 0, 0, pageW, pageH, undefined, "FAST");

        const filename = this.buildDocFilename(docType, p, extra);
        pdf.save(filename);

        this.logActivity("Document Downloaded", `${docType} • ${p.title}`);
      },

      buildDocFilename(docType, p, extra) {
        const safe = (s) => String(s).replace(/[^\w\-]+/g, "_").slice(0, 60);
        if (docType === "Receipt") return `AMADA-RECEIPT-${safe(extra.txnId || "TXN")}.pdf`;
        return `AMADA-${docType.toUpperCase()}-${safe(p.title)}-${p.id}.pdf`;
      },

      buildLuxuryDocHTML(docType, p, extra) {
        const u = this.state.user;
        const now = new Date();
        const dateStr = now.toLocaleString();

        const seal = (docType === "Deed") ? "DEED" :
          (docType === "Authenticity") ? "AUTH" :
          (docType === "Receipt") ? "RCPT" : "CERT";

        const watermark = (docType === "Receipt") ? "AMADA" : "SOVEREIGN";

        const bodyText = {
          "Certificate": `
            This certificate confirms that the asset described herein has been recorded and stamped under Amada’s
            documentation protocol. The client listed below is recognized as the verified holder in this demo environment.
            In production, this certificate would be cryptographically signed and publicly verifiable via registry partners.
          `,
          "Deed": `
            This deed represents a formal conveyance record for the associated asset class, presented with ceremonial
            clarity. For this demo, ownership is simulated and stored locally. In production, deed issuance would be bound
            to registry integration, legal review, and a verifiable ledger stamp.
          `,
          "Authenticity": `
            This letter certifies the authenticity of the associated asset representation, including the documentation
            package, issuance stamp, and identity binding to the client record. It is designed for high-trust transfer,
            discreet gifting, or vault storage presentation.
          `,
          "Receipt": `
            This receipt confirms the execution of an acquisition event in the Amada private marketplace. It records the
            client identity, asset details, valuation, and transaction reference used for internal tracking.
          `
        }[docType] || "";

        const statusLine = (docType === "Receipt")
          ? `TRANSACTION CONFIRMED • ${this.escapeHtml(extra.txnId || this.newTxnId())}`
          : `CERTIFIED • VAULT STAMP • LEDGER READY`;

        const price = this.formatMoney(p.price);
        const certId = `AMADA-${seal}-${String(p.id).padStart(6, "0")}`;

        const extraRows = (docType === "Receipt") ? `
          <div class="doc-card">
            <div class="doc-k">Transaction ID</div>
            <div class="doc-v mono">${this.escapeHtml(extra.txnId || this.newTxnId())}</div>
          </div>
          <div class="doc-card">
            <div class="doc-k">Payment Method</div>
            <div class="doc-v">${this.escapeHtml(extra.method || "Private Gateway (Demo)")}</div>
          </div>
        ` : `
          <div class="doc-card">
            <div class="doc-k">Document ID</div>
            <div class="doc-v mono">${this.escapeHtml(certId)}</div>
          </div>
          <div class="doc-card">
            <div class="doc-k">Issuance Class</div>
            <div class="doc-v">${this.escapeHtml(p.type)} • Tier ${p.tier} (${this.escapeHtml(this.tierName(p.tier))})</div>
          </div>
        `;

        return `
          <div class="doc-a4">
            <div class="doc-watermark">${watermark}</div>
            <div class="doc-border"></div>

            <div class="doc-inner">
              <div class="doc-head">
                <div>
                  <div class="doc-brand">
                    <div class="doc-seal"><i class="fas fa-crown"></i></div>
                    <div>AMADA</div>
                  </div>
                  <div class="doc-title">${this.escapeHtml(docType)} of ${seal}</div>
                  <div class="doc-subtitle">${statusLine}</div>
                </div>

                <div style="text-align:right">
                  <div class="doc-qr">
                    QR / Verify<br/>
                    <span class="mono">${this.escapeHtml(`AMADA://${seal}/${p.id}`)}</span>
                  </div>
                  <div class="doc-subtitle" style="margin-top:10px">${this.escapeHtml(dateStr)}</div>
                </div>
              </div>

              <div class="doc-grid">
                <div class="doc-card">
                  <div class="doc-k">Client</div>
                  <div class="doc-v">${this.escapeHtml(u.name)}</div>
                </div>
                <div class="doc-card">
                  <div class="doc-k">Client ID</div>
                  <div class="doc-v mono">${this.escapeHtml(u.clientId)}</div>
                </div>

                <div class="doc-card">
                  <div class="doc-k">Asset</div>
                  <div class="doc-v">${this.escapeHtml(p.title)}</div>
                </div>
                <div class="doc-card">
                  <div class="doc-k">Valuation</div>
                  <div class="doc-v">${this.escapeHtml(price)}</div>
                </div>

                <div class="doc-card">
                  <div class="doc-k">Location</div>
                  <div class="doc-v">${this.escapeHtml(p.location || "Amada Vault")}</div>
                </div>
                <div class="doc-card">
                  <div class="doc-k">Status</div>
                  <div class="doc-v">${this.escapeHtml(p.status || "Available")}</div>
                </div>

                ${extraRows}
              </div>

              <div class="doc-body">
                <p style="margin:0 0 14px 0;">
                  <b style="font-family:'Cinzel',serif; letter-spacing:0.12em; text-transform:uppercase;">
                    Statement of Record
                  </b>
                </p>
                <p style="margin:0">${this.escapeHtml(bodyText).replaceAll("\n", "<br/>")}</p>

                <div style="margin-top:18px; padding:14px; border-radius:16px; border:1px solid rgba(212,175,55,0.35); background:rgba(212,175,55,0.08);">
                  <div style="font-size:11px; letter-spacing:0.12em; text-transform:uppercase; font-weight:800; color:#111;">
                    Discretion Notice
                  </div>
                  <div style="font-size:12px; margin-top:6px; color:#374151;">
                    This document is designed for private presentation. Distribution implies consent to the Amada protocol.
                  </div>
                </div>

                <div class="doc-sign">
                  <div>
                    <div class="sig-line"><b>Director, Amada Realty</b><br/>Signature / Seal</div>
                  </div>
                  <div>
                    <div class="sig-line"><b>Client Acknowledgment</b><br/>Signature</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="doc-foot">
              <div>AMADA • The Sovereign Standard</div>
              <div class="mono">DOC:${this.escapeHtml(seal)}-${String(p.id).padStart(6, "0")}</div>
            </div>
          </div>
        `;
      },

      // -------------------------
      // MISC: static docs are handled through exportStaticDoc
      // -------------------------

      // -------------------------
      // PUBLIC: concierge anchor
      // -------------------------
      scrollToConcierge() {
        const el = document.getElementById("concierge");
        if (el) el.scrollIntoView({ behavior: "smooth" });
      }
    };

    // Boot
    App.init();

    // Keep marketplace filter count updated on first load (if dashboard open later)
    setTimeout(() => {
      const slider = document.getElementById("shop-tier-slider");
      if (slider) App.setShopTier(slider.value, true);
    }, 200);
  </script>
</body>
</html>
